<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scientific Calculator</title>
  <link rel="icon" type="image/x-icon" href="favicon.png">
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      color-scheme: light dark;
      --bg: #f7f8fb;
      --card: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --border: #e5e7eb;
      --accent: #2563eb;
      --accent-strong: #1d4ed8;
      --shadow: 0 18px 55px rgba(17, 24, 39, 0.08);
      --radius-lg: 16px;
      --radius: 10px;
      --display-bg: #1f2937;
      --display-text: #f3f4f6;
      --btn-primary: #3b82f6;
      --btn-secondary: #6b7280;
      --btn-danger: #ef4444;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0f172a;
        --card: #111827;
        --text: #e5e7eb;
        --muted: #9ca3af;
        --border: #1f2937;
        --accent: #60a5fa;
        --accent-strong: #3b82f6;
        --shadow: 0 22px 60px rgba(0, 0, 0, 0.55);
        --display-bg: #111827;
        --display-text: #f3f4f6;
        --btn-primary: #3b82f6;
        --btn-secondary: #6b7280;
        --btn-danger: #ef4444;
      }
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(96, 165, 250, 0.12), transparent 32%),
                  radial-gradient(circle at 80% 0%, rgba(99, 102, 241, 0.10), transparent 36%),
                  var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 3.5rem 1rem;
    }

    .card {
      width: min(420px, 100%);
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      padding: 1.5rem;
      display: grid;
      gap: 1rem;
    }

    header { 
      display: flex; 
      flex-direction: column; 
      gap: 0.35rem; 
      text-align: center;
    }

    h1 {
      margin: 0;
      font-size: 1.8rem;
      letter-spacing: -0.02em;
      font-weight: 700;
    }

    .subtitle { 
      margin: 0; 
      color: var(--muted); 
      font-weight: 500; 
      font-size: 0.9rem;
    }

    .display {
      background: var(--display-bg);
      color: var(--display-text);
      border-radius: var(--radius);
      padding: 1.2rem;
      text-align: right;
      font-family: 'Source Code Pro', monospace;
      font-size: 1.8rem;
      font-weight: 500;
      min-height: 3.5rem;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      word-break: break-all;
      overflow-wrap: break-word;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .display.secondary {
      font-size: 1rem;
      opacity: 0.7;
      min-height: 1.5rem;
    }

    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.5rem;
    }

    button {
      border: none;
      border-radius: var(--radius);
      padding: 1rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 150ms ease;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 3.5rem;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .btn-number {
      background: var(--card);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-number:hover {
      background: color-mix(in srgb, var(--accent) 10%, var(--card));
      border-color: var(--accent);
    }

    .btn-operator {
      background: var(--btn-primary);
      color: white;
    }

    .btn-operator:hover {
      background: var(--accent-strong);
    }

    .btn-function {
      background: var(--btn-secondary);
      color: white;
    }

    .btn-function:hover {
      background: #4b5563;
    }

    .btn-clear {
      background: var(--btn-danger);
      color: white;
    }

    .btn-clear:hover {
      background: #dc2626;
    }

    .btn-equals {
      background: #10b981;
      color: white;
      grid-column: span 2;
    }

    .btn-equals:hover {
      background: #059669;
    }

    .btn-zero {
      grid-column: span 2;
    }

    .history {
      margin-top: 1rem;
      padding: 1rem;
      background: color-mix(in srgb, var(--card) 90%, var(--bg));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      max-height: 150px;
      overflow-y: auto;
    }

    .history h3 {
      margin: 0 0 0.5rem 0;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .history-item {
      font-family: 'Source Code Pro', monospace;
      font-size: 0.85rem;
      color: var(--text);
      padding: 0.25rem 0;
      border-bottom: 1px solid var(--border);
    }

    .history-item:last-child {
      border-bottom: none;
    }

    @media (max-width: 480px) {
      body { padding: 2.25rem 1rem; }
      .card { padding: 1rem; }
      .display { font-size: 1.5rem; }
      button { padding: 0.8rem; font-size: 1rem; min-height: 3rem; }
    }
  </style>
</head>
<body>
  <main class="card" role="main" aria-label="Scientific Calculator">
    <header>
      <h1>Scientific Calculator</h1>
      <p class="subtitle">Advanced calculations with history tracking</p>
    </header>

    <div class="display secondary" id="expression" aria-live="polite"></div>
    <div class="display" id="display" aria-live="polite">0</div>

    <div class="buttons">
      <!-- Row 1: Scientific functions -->
      <button class="btn-function" onclick="appendFunction('sin(')">sin</button>
      <button class="btn-function" onclick="appendFunction('cos(')">cos</button>
      <button class="btn-function" onclick="appendFunction('tan(')">tan</button>
      <button class="btn-function" onclick="appendOperator('^')">x^y</button>

      <!-- Row 2: More scientific functions -->
      <button class="btn-function" onclick="appendFunction('log(')">log</button>
      <button class="btn-function" onclick="appendFunction('ln(')">ln</button>
      <button class="btn-function" onclick="appendFunction('sqrt(')">√</button>
      <button class="btn-function" onclick="appendOperator('/')">÷</button>

      <!-- Row 3: Clear and numbers -->
      <button class="btn-clear" onclick="clearAll()">AC</button>
      <button class="btn-function" onclick="deleteLast()">⌫</button>
      <button class="btn-function" onclick="appendOperator('%')">%</button>
      <button class="btn-function" onclick="appendOperator('*')">×</button>

      <!-- Row 4: Numbers 7-9 -->
      <button class="btn-number" onclick="appendNumber('7')">7</button>
      <button class="btn-number" onclick="appendNumber('8')">8</button>
      <button class="btn-number" onclick="appendNumber('9')">9</button>
      <button class="btn-function" onclick="appendOperator('-')">−</button>

      <!-- Row 5: Numbers 4-6 -->
      <button class="btn-number" onclick="appendNumber('4')">4</button>
      <button class="btn-number" onclick="appendNumber('5')">5</button>
      <button class="btn-number" onclick="appendNumber('6')">6</button>
      <button class="btn-function" onclick="appendOperator('+')">+</button>

      <!-- Row 6: Numbers 1-3 -->
      <button class="btn-number" onclick="appendNumber('1')">1</button>
      <button class="btn-number" onclick="appendNumber('2')">2</button>
      <button class="btn-number" onclick="appendNumber('3')">3</button>
      <button class="btn-function" onclick="appendNumber('.')">.</button>

      <!-- Row 7: Zero and equals -->
      <button class="btn-number btn-zero" onclick="appendNumber('0')">0</button>
      <button class="btn-function" onclick="appendOperator('(')">(</button>
      <button class="btn-function" onclick="appendOperator(')')">)</button>
      <button class="btn-equals" onclick="calculate()">=</button>
    </div>

    <div class="history" id="history">
      <h3>History</h3>
      <div id="history-list"></div>
    </div>
  </main>

  <script>
    let currentInput = '0';
    let expression = '';
    let history = [];

    const display = document.getElementById('display');
    const expressionDisplay = document.getElementById('expression');
    const historyList = document.getElementById('history-list');

    function updateDisplay() {
      display.textContent = currentInput;
      expressionDisplay.textContent = expression;
    }

    function appendNumber(num) {
      if (currentInput === '0' && num !== '.') {
        currentInput = num;
      } else {
        currentInput += num;
      }
      expression += num;
      updateDisplay();
    }

    function appendOperator(op) {
      if (currentInput === '' && op === '-') {
        currentInput = '-';
        expression = '-';
      } else if (currentInput !== '') {
        expression += op;
        currentInput = '';
      }
      updateDisplay();
    }

    function appendFunction(func) {
      expression += func;
      currentInput = '';
      updateDisplay();
    }

    function clearAll() {
      currentInput = '0';
      expression = '';
      updateDisplay();
    }

    function deleteLast() {
      if (currentInput.length > 0) {
        currentInput = currentInput.slice(0, -1);
        expression = expression.slice(0, -1);
      } else if (expression.length > 0) {
        expression = expression.slice(0, -1);
      }
      
      if (currentInput === '') currentInput = '0';
      if (expression === '') expression = '';
      updateDisplay();
    }

    function evaluateExpression(expr) {
      try {
        // Replace mathematical functions and constants
        expr = expr.replace(/sin\(/g, 'Math.sin(');
        expr = expr.replace(/cos\(/g, 'Math.cos(');
        expr = expr.replace(/tan\(/g, 'Math.tan(');
        expr = expr.replace(/log\(/g, 'Math.log10(');
        expr = expr.replace(/ln\(/g, 'Math.log(');
        expr = expr.replace(/sqrt\(/g, 'Math.sqrt(');
        expr = expr.replace(/\^/g, '**');
        expr = expr.replace(/×/g, '*');
        expr = expr.replace(/÷/g, '/');
        expr = expr.replace(/−/g, '-');

        // Evaluate the expression
        const result = Function('"use strict"; return (' + expr + ')')();
        
        if (isNaN(result) || !isFinite(result)) {
          throw new Error('Invalid result');
        }
        
        return result;
      } catch (error) {
        throw new Error('Invalid expression');
      }
    }

    function calculate() {
      if (expression === '') return;
      
      try {
        const fullExpression = expression + currentInput;
        const result = evaluateExpression(fullExpression);
        
        // Add to history
        const historyItem = `${fullExpression} = ${result}`;
        history.unshift(historyItem);
        if (history.length > 10) history.pop();
        updateHistory();
        
        // Update display
        currentInput = result.toString();
        expression = '';
        updateDisplay();
      } catch (error) {
        currentInput = 'Error';
        updateDisplay();
        setTimeout(() => {
          currentInput = '0';
          updateDisplay();
        }, 1500);
      }
    }

    function updateHistory() {
      historyList.innerHTML = history.map(item => 
        `<div class="history-item">${item}</div>`
      ).join('');
    }

    // Keyboard support
    document.addEventListener('keydown', (e) => {
      if (e.key >= '0' && e.key <= '9') appendNumber(e.key);
      else if (e.key === '.') appendNumber('.');
      else if (e.key === '+') appendOperator('+');
      else if (e.key === '-') appendOperator('-');
      else if (e.key === '*') appendOperator('*');
      else if (e.key === '/') appendOperator('/');
      else if (e.key === '(') appendOperator('(');
      else if (e.key === ')') appendOperator(')');
      else if (e.key === 'Enter' || e.key === '=') calculate();
      else if (e.key === 'Escape') clearAll();
      else if (e.key === 'Backspace') deleteLast();
    });

    // Initialize
    updateDisplay();
  </script>
</body>
</html>
